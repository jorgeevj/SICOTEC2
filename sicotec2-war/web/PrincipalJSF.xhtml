<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
jorgeevj 15.09.15 Creacion.
-->
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <f:view contentType="text/html">
        <h:head>
            <f:facet name="first">
                <meta content='text/html; charset=UTF-8' http-equiv="Content-Type"/>
                <style>
                    .hideborder tr td{
                        border: hidden !important;
                    }
                </style>
                <title>SICOTEC</title>
            </f:facet>
        </h:head>

        <h:body>

            <p:layout fullPage="true" >

                <p:layoutUnit position="north" size="142" resizable="true" closable="true" collapsible="true">
                    <img src="../imagenes/barralogotiposervacom.png" alt=""/>
                </p:layoutUnit>

                <p:layoutUnit position="west" size="175" header="SICOTEC" collapsible="true" >
                    <p:menu style=" width: 152px"> 
                        <c:forEach var="permiso" items="#{indexMB.permisos}">
                            <p:menuitem value="#{permiso.nombre}" url="#{permiso.url}" style="background-color: background"/>
                        </c:forEach>
                    </p:menu>
                </p:layoutUnit>

                <p:layoutUnit position="center">
                    <ui:insert name="body" >
                        Bienvenido a SICOTEC

                    </ui:insert>

                </p:layoutUnit>


            </p:layout>


            <!-- DIALOG DE COTIZACIONES-->
            <p:dialog header="REGISTRAR COTIZACION" widgetVar="regCot" modal="true" rendered="true" height="450">

                <h:form id="formRegCot" >
                    <p:panelGrid id="pGridRegCot" columns="4" styleClass="hideborder">
                        <p:outputLabel value="Duracion/Dias:" for="itrc2" />
                        <p:inputText id="itrc2" value="#{cotizacionMB.camposCrear.duracion}" required="true"/>

                        <p:outputLabel value="Entregar:" for="itrc3" />
                        <p:selectOneMenu id="itrc3" value="#{cotizacionMB.camposCrear.entrega}" required="true">
                            <f:selectItem itemLabel="Seleccione" itemValue="" />
                            <f:selectItem itemLabel="Domicilio" itemValue="0" />
                            <f:selectItem itemLabel="Almacen" itemValue="1" />
                        </p:selectOneMenu>

                        <p:outputLabel for="choiceEmpRC" value="Empresa: "/>
                        <p:selectOneMenu id="choiceEmpRC" value="#{cotizacionMB.camposCrear.idempresa.idempresa}" 
                                         required="true" >
                            <f:selectItem itemLabel="Seleccione" itemValue="" />
                            <f:selectItems value="#{cotizacionMB.listaEmpresas}" var="emp" 
                                           itemValue="#{emp.idempresa}" itemLabel="#{emp.nombre}"/>
                        </p:selectOneMenu>

                        <p:outputLabel for="almacenesRC" value="Almacen:" />
                        <p:selectOneMenu id="almacenesRC" value="#{cotizacionMB.camposCrear.idalmacen}" 
                                         valueChangeListener="#{cotizacionMB.almacenSelect}" required="true">
                            <p:ajax update="TipoitemSelect" />
                            <f:selectItem itemLabel="Seleccione" itemValue="" />
                            <f:selectItems value="#{cotizacionMB.listaAlmacenes}" var="alm" 
                                           itemValue="#{alm.idalmacen}" itemLabel="#{alm.nombre}"/>
                        </p:selectOneMenu>

                    </p:panelGrid>

                    <p:dataTable id="tablaTipoitem" widgetVar="tTipoitem" value="#{cotizacionMB.listaTipoItem}" var="titem"
                                 emptyMessage="No se encontraron Items" filteredValue="#{cotizacionMB.filtroTipoItem}"
                                 selectionMode="single" rowKey="#{titem.idtipoItem}" selection="#{cotizacionMB.tipoItemSelect}"
                                 scrollable="true" rows="5" >
                        <p:ajax event="rowSelect" listener="#{cotizacionMB.selectAgregarCrear}" update=":formRegCot:btnAgregarItemCot,:formRegCot:messages"/> 
                        <f:facet name="header">
                            Lista de Items
                        </f:facet>
                        <p:column headerText="Cod Item" filterBy="#{titem.idtipoItem}">
                            <h:outputText value="#{titem.idtipoItem}" />
                        </p:column>
                        <p:column headerText="Nombre" filterBy="#{titem.nombre}">
                            <h:outputText value="#{titem.nombre}" />
                        </p:column>
                        <p:column headerText="Categoria" filterBy="#{titem.idfamilia.idcategoria.nombre}">
                            <f:facet name="filter">
                                <p:selectOneMenu onchange="PF('tTipoitem').filter()" style="width:100%">
                                    <f:selectItem itemLabel="Seleccione" itemValue="#{null}" noSelectionOption="true" />
                                    <f:selectItems value="#{cotizacionMB.listaCategoria}" var="cat"
                                                   itemLabel="#{cat.nombre}" itemValue="#{cat.nombre}" />
                                </p:selectOneMenu>
                            </f:facet>
                            <h:outputText value="#{titem.idfamilia.idcategoria.nombre}" />
                        </p:column>
                        <p:column headerText="Familia" filterBy="#{titem.idfamilia.nombre}">
                            <h:outputText value="#{titem.idfamilia.nombre}" />
                        </p:column>
                        <p:column headerText="Descripcion" filterBy="#{titem.descripcion}">
                            <h:outputText value="#{titem.descripcion}" />
                        </p:column>
                        <p:column headerText="NÂ° Parte" filterBy="#{titem.numParte}">
                            <h:outputText value="#{titem.numParte}" />
                        </p:column>
                        <p:column headerText="Marca" filterBy="#{titem.idmarca.nombre}">
                            <h:outputText value="#{titem.idmarca.nombre}" />
                        </p:column>
                        <p:column headerText="Color" filterBy="#{titem.idcolor.nombre}">
                            <h:outputText value="#{titem.idcolor.nombre}" />
                        </p:column>
                        <p:column headerText="Pecio Lista" filterBy="#{titem.precioLista}">
                            <h:outputText value="#{titem.precioLista}" />
                        </p:column>
                    </p:dataTable>

                    <p:messages id="messages" showDetail="true" closable="true" />
                    <p:panelGrid columns="2" styleClass="hideborder">
                        <p:commandButton id="btnAgregarItemCot" value="Agregar" 
                                         actionListener="#{cotizacionMB.agregarCrear}" title="Agregar" 
                                         disabled="#{cotizacionMB.btnAgregarItem}" update="TipoitemSelect,messages"/>
                        <p:commandButton id="btnQuitarItemCot" value="Quitar" 
                                         actionListener="#{cotizacionMB.quitarCrear}"
                                         disabled="#{cotizacionMB.btnQuitarItem}" update="TipoitemSelect,btnQuitarItemCot"/>

                    </p:panelGrid>
                    <p:remoteCommand name="onCellEdit" update="TipoitemSelect" />
                    <p:dataTable id="TipoitemSelect" widgetVar="tItemSelectCrea"
                                 value="#{cotizacionMB.listaCotipoItem}" var="coitem"
                                 editable="true" editMode="cell" selection="#{cotizacionMB.listaCoItemSelect}"
                                 rowKey="#{coitem.tipoitem.idtipoItem}"
                                 emptyMessage="No se encontraron Items" style="margin-bottom:0">
                        <p:ajax event="rowSelect" listener="#{cotizacionMB.selectQuitarCrear}" update=":formRegCot:btnQuitarItemCot" />
                        <p:ajax event="cellEdit" oncomplete="onCellEdit()" />
                        <f:facet name="header">
                            Lista de Items Seleccionados
                        </f:facet>
                        <p:column headerText="Cod Item" >
                            <h:outputText value="#{coitem.tipoitem.idtipoItem}" />
                        </p:column>
                        <p:column headerText="Nombre" >
                            <h:outputText value="#{coitem.tipoitem.nombre}" />
                        </p:column>
                        <p:column headerText="Stock" >
                            <h:outputText value="#{coitem.stock}" />
                        </p:column>
                        <p:column headerText="Cantidad" >
                            <p:cellEditor>
                                <f:facet name="output"><h:outputText value="#{coitem.cantidad}" /></f:facet>
                                <f:facet name="input"><p:inputText id="modelInput" value="#{coitem.cantidad}" style="width:96%" /></f:facet>
                            </p:cellEditor>
                        </p:column>
                        <p:column headerText="Precio U." >
                            <h:outputText value="#{coitem.precio}" />
                        </p:column>
                        <p:column headerText="Sub. Total" >
                            <h:outputText value="#{coitem.cantidad*coitem.precio}" />
                        </p:column>
                        <p:column style="width:32px;text-align: center">
                            <p:commandButton  id="btnEditPrecioCrea" icon="ui-icon-pencil" update="formPrecioCrear"
                                              title="editar" actionListener="#{cotizacionMB.openPrecioCrea}"
                                              oncomplete="PF('editItemPrecio').show()">
                                <f:setPropertyActionListener value="#{coitem}" target="#{cotizacionMB.cotipoItemSelect}" /> 
                        </p:commandButton>
                    </p:column>
                    <p:column selectionMode="multiple" style="width:16px;text-align:center"/>
                    <f:facet name="footer" >
                        <p:panelGrid>
                            <p:row>
                                <p:column style="text-align: right" >
                                    Total 
                                </p:column>
                                <p:column style="width:161px;text-align: center">
                                    #{cotizacionMB.totalCotizacion()}
                                </p:column>   
                                <p:column style="width:59px;text-align: center" >
                                    $
                                </p:column>
                            </p:row>

                        </p:panelGrid>
                    </f:facet>
                </p:dataTable>

                <p:panelGrid columns="4" styleClass="hideborder">
                    <p:commandButton id="btnGuardarReg" value="Guardar" 
                                     actionListener="#{cotizacionMB.guardarCrear}" 
                                     update="messages"/>
                    <p:commandButton id="btnEnviarReg" value="Enviar" actionListener="#{cotizacionMB.enviaCrear}" />
                    <p:commandButton id="btnAprobadaReg" value="Aprobada" 
                                     actionListener="#{cotizacionMB.aprobarCrea}" 
                                     update="formAproCrea:AproCrea,messages"/> 
                    <p:commandButton id="btnCancelReg" value="Cancelar" 
                                     actionListener="#{cotizacionMB.cerrarCrear}" 
                                     update="formRegCot"/>
                </p:panelGrid>
            </h:form>
        </p:dialog> 

        <p:dialog header="EDITAR PRECIO" widgetVar="editItemPrecio" modal="true" rendered="true" >
            <h:form id="formPrecioCrear">
                <p:panelGrid columns="2" styleClass="hideborder">
                    <p:outputLabel value="Precio:" for="precioEditCrea" />
                    <p:inputText id="precioEditCrea" value="#{cotizacionMB.chamgePrecioCrea}" />
                    <p:outputLabel value="Precio Unitario: Minimo #{cotizacionMB.minPrecioCrea}" />
                    <p:messages id="messages2" showDetail="true" closable="true" />
                    <p:commandButton id="btnAceptaPrecio" value="Aceptar" 
                                     actionListener="#{cotizacionMB.aceptarPrecioCrea}" 
                                     update=":formRegCot:TipoitemSelect,messages2,:formEditCot:TipoitemSelectEdit"/>
                    <p:commandButton id="btnCancelaPrecio" value="Cancelar" 
                                     actionListener="#{cotizacionMB.cerrarPrecioCrear}" 
                                     onclick="PF('editItemPrecio').hide();"/>
                </p:panelGrid>
            </h:form>
        </p:dialog> 

        <p:dialog header="Aprobar Venta" widgetVar="aproVentaCrea" modal="true" rendered="true" >
            <h:form id="formAproCrea">
                <p:dataTable id="AproCrea" widgetVar="aproCrea"
                             value="#{cotizacionMB.listaCoItemSelect}" var="coitem"
                             rowKey="#{coitem.tipoitem.idtipoItem}"
                             emptyMessage="No se encontraron Items" style="margin-bottom:0">

                    <f:facet name="header">
                        Lista de Items Aprobados
                    </f:facet>
                    <p:column headerText="Cod Item" >
                        <h:outputText value="#{coitem.tipoitem.idtipoItem}" />
                    </p:column>
                    <p:column headerText="Nombre" > 
                        <h:outputText value="#{coitem.tipoitem.nombre}" />
                    </p:column>
                    <p:column headerText="Stock" >
                        <h:outputText value="#{coitem.stock}" />
                    </p:column>
                    <p:column headerText="Cantidad" >
                        <h:outputText value="#{coitem.cantidad}" />  
                    </p:column>
                    <p:column headerText="Precio U." >
                        <h:outputText value="#{coitem.precio}" />
                    </p:column>
                    <p:column headerText="Sub. Total" >
                        <h:outputText value="#{coitem.cantidad*coitem.precio}" />
                    </p:column>
                    <f:facet name="footer" >
                        <p:panelGrid>
                            <p:row>
                                <p:column style="text-align: right" >
                                    Total $ 
                                </p:column>
                                <p:column style="width:161px;text-align: center">
                                    #{cotizacionMB.totalAprovado()}
                                </p:column>   
                            </p:row>

                        </p:panelGrid>
                    </f:facet>
                </p:dataTable>
                <p:commandButton id="btnAcepApro" value="Aceptar" actionListener="#{cotizacionMB.acepAproCrear}" />
                <p:commandButton id="btnCancelApro" value="Cancelar" actionListener="#{cotizacionMB.cerrarAproCrear}" />
            </h:form>
        </p:dialog>
         
            <p:dialog header="EDITAR COTIZACION" widgetVar="editCot" modal="true" rendered="true" height="500">

                <h:form id="formEditCot" >
                    <p:panelGrid id="pGridEditCot2" columns="4" styleClass="hideborder">
                        <p:outputLabel value="Duracion/Dias:" for="itec2" />
                        <p:inputText id="itec2" value="#{cotizacionMB.cotizacionSelec.duracion}" required="true"/>

                        <p:outputLabel value="Entrega:" for="itec3" />
                        <p:selectOneMenu id="itec3" value="#{cotizacionMB.cotizacionSelec.entrega}" required="true">
                            <f:selectItem itemLabel="Seleccione" itemValue="" />
                            <f:selectItem itemLabel="Domicilio" itemValue="0" />
                            <f:selectItem itemLabel="Almacen" itemValue="1" />
                        </p:selectOneMenu>

                        <p:outputLabel for="choiceEmpEC" value="Empresa: "/>
                        <p:selectOneMenu id="choiceEmpEC" value="#{cotizacionMB.cotizacionSelec.empresaDTO.idemp}" 
                                         required="true" >
                            <f:selectItem itemLabel="Seleccione" itemValue="" />
                            <f:selectItems value="#{cotizacionMB.listaEmpresas}" var="emp" 
                                           itemValue="#{emp.idempresa}" itemLabel="#{emp.nombre}"/>
                        </p:selectOneMenu>

                        <p:outputLabel for="almacenesEC" value="Almacen:" />
                        <p:selectOneMenu id="almacenesEC" value="#{cotizacionMB.cotizacionSelec.idalm}" 
                                         valueChangeListener="#{cotizacionMB.almacenSelect}" required="true">
                            <p:ajax update="TipoitemSelectEdit" />
                            <f:selectItem itemLabel="Seleccione" itemValue="" />
                            <f:selectItems value="#{cotizacionMB.listaAlmacenes}" var="alm" 
                                           itemValue="#{alm.idalmacen}" itemLabel="#{alm.nombre}"/>
                        </p:selectOneMenu>

                    </p:panelGrid>

                    <p:dataTable id="tablaTipoitemEdit" widgetVar="tTipoitemEdit" value="#{cotizacionMB.listaTipoItem}" var="titem"
                                 emptyMessage="No se encontraron Items" filteredValue="#{cotizacionMB.filtroTipoItem}"
                                 selectionMode="single" rowKey="#{titem.idtipoItem}" selection="#{cotizacionMB.tipoItemSelect}"
                                 scrollable="true" rows="5" >
                        <p:ajax event="rowSelect" listener="#{cotizacionMB.selectAgregarCrear}" update=":formEditCot:btnAgregarItemCotEdit,:formEditCot:messagesEdit"/> 
                        <f:facet name="header">
                            Lista de Items
                        </f:facet>
                        <p:column headerText="Cod Item" filterBy="#{titem.idtipoItem}">
                            <h:outputText value="#{titem.idtipoItem}" />
                        </p:column>
                        <p:column headerText="Nombre" filterBy="#{titem.nombre}">
                            <h:outputText value="#{titem.nombre}" />
                        </p:column>
                        <p:column headerText="Categoria" filterBy="#{titem.idfamilia.idcategoria.nombre}">
                            <f:facet name="filter">
                                <p:selectOneMenu onchange="PF('tTipoitemEdit').filter()" style="width:100%">
                                    <f:selectItem itemLabel="Seleccione" itemValue="#{null}" noSelectionOption="true" />
                                    <f:selectItems value="#{cotizacionMB.listaCategoria}" var="cat"
                                                   itemLabel="#{cat.nombre}" itemValue="#{cat.nombre}" />
                                </p:selectOneMenu>
                            </f:facet>
                            <h:outputText value="#{titem.idfamilia.idcategoria.nombre}" />
                        </p:column>
                        <p:column headerText="Familia" filterBy="#{titem.idfamilia.nombre}">
                            <h:outputText value="#{titem.idfamilia.nombre}" />
                        </p:column>
                        <p:column headerText="Descripcion" filterBy="#{titem.descripcion}">
                            <h:outputText value="#{titem.descripcion}" />
                        </p:column>
                        <p:column headerText="NÂ° Parte" filterBy="#{titem.numParte}">
                            <h:outputText value="#{titem.numParte}" />
                        </p:column>
                        <p:column headerText="Marca" filterBy="#{titem.idmarca.nombre}">
                            <h:outputText value="#{titem.idmarca.nombre}" />
                        </p:column>
                        <p:column headerText="Color" filterBy="#{titem.idcolor.nombre}">
                            <h:outputText value="#{titem.idcolor.nombre}" />
                        </p:column>
                        <p:column headerText="Pecio Lista" filterBy="#{titem.precioLista}">
                            <h:outputText value="#{titem.precioLista}" />
                        </p:column>
                    </p:dataTable>

                    <p:messages id="messagesEdit" showDetail="true" closable="true" />
                    <p:panelGrid columns="2" styleClass="hideborder">
                        <p:commandButton id="btnAgregarItemCotEdit" value="Agregar" 
                                         actionListener="#{cotizacionMB.agregarCrear}" title="Agregar" 
                                         disabled="#{cotizacionMB.btnAgregarItem}" update="TipoitemSelectEdit,messagesEdit"/>
                        <p:commandButton id="btnQuitarItemCotEdit" value="Quitar" 
                                         actionListener="#{cotizacionMB.quitarCrear}"
                                         disabled="#{cotizacionMB.btnQuitarItem}" update="TipoitemSelectEdit,btnQuitarItemCotEdit"/>
                        
                    </p:panelGrid>
                    <p:remoteCommand name="onCellEdit2" update="TipoitemSelectEdit" />
                    <p:dataTable id="TipoitemSelectEdit" widgetVar="tItemSelectEdit"
                                 value="#{cotizacionMB.listaCotipoItem}" var="coitem"
                                 editable="true" editMode="cell" selection="#{cotizacionMB.listaCoItemSelect}"
                                 rowKey="#{coitem.tipoitem.idtipoItem}"
                                 emptyMessage="No se encontraron Items" style="margin-bottom:0">
                        <p:ajax event="rowSelect" listener="#{cotizacionMB.selectQuitarCrear}" update=":formEditCot:btnQuitarItemCotEdit" />
                        <p:ajax event="cellEdit" oncomplete="onCellEdit2()" />
                        <f:facet name="header">
                            <p:column colspan="8">
                                Lista de Items Seleccionados
                            </p:column>
                        </f:facet>
                        <p:column headerText="Cod Item" >
                            <h:outputText value="#{coitem.tipoitem.idtipoItem}" />
                        </p:column>
                        <p:column headerText="Nombre" >
                            <h:outputText value="#{coitem.tipoitem.nombre}" />
                        </p:column>
                        <p:column headerText="Stock" >
                            <h:outputText value="#{coitem.stock}" />
                        </p:column>
                        <p:column headerText="Cantidad" >
                            <p:cellEditor>
                                <f:facet name="output"><h:outputText value="#{coitem.cantidad}" /></f:facet>
                                <f:facet name="input"><p:inputText id="modelInput" value="#{coitem.cantidad}" style="width:96%" /></f:facet>
                            </p:cellEditor>
                        </p:column>
                        <p:column headerText="Precio U." >
                            <h:outputText value="#{coitem.precio}" />
                        </p:column>
                        <p:column headerText="Sub. Total" >
                            <h:outputText value="#{coitem.cantidad*coitem.precio}" />
                        </p:column>
                        <p:column style="width:32px;text-align: center">
                            <p:commandButton id="btnEditPrecioEdit" icon="ui-icon-pencil" update="formPrecioCrear"
                                             title="editar" actionListener="#{cotizacionMB.openPrecioedit}"
                                             oncomplete="PF('editItemPrecio').show()">
                                <!-- <f:setPropertyActionListener value="#{coitem}" target="#{cotizacionMB.cotipoItemSelectEdit}" /> -->
                                <f:attribute name="myattribute" value="#{coitem}" /> 
                            </p:commandButton>
                        </p:column>
                        <p:column selectionMode="multiple" style="width:16px;text-align:center"/>
                        <f:facet name="footer" >
                            <p:panelGrid>
                                <p:row>
                                    <p:column style="text-align: right" >
                                        Total 
                                    </p:column>
                                    <p:column style="width:161px;text-align: center">
                                        #{cotizacionMB.totalCotizacion()}
                                    </p:column>   
                                    <p:column style="width:59px;text-align: center" >
                                        $
                                    </p:column>
                                </p:row>

                            </p:panelGrid>
                        </f:facet>
                    </p:dataTable>

                    <p:panelGrid columns="4" styleClass="hideborder">
                        <p:commandButton id="btnGuardarEdit" value="Guardar" 
                                         actionListener="#{cotizacionMB.GuardarEditar}" 
                                         update="messagesEdit"/>
                        <p:commandButton id="btnEnviarEdit" value="Enviar" 
                                         actionListener="#{cotizacionMB.enviaCrear}" />
                        <p:commandButton id="btnAprobadaEdit" value="Aprobada" 
                                         actionListener="#{cotizacionMB.aprobarCrea}" 
                                         update="formAproCrea:AproCrea,messagesEdit"/> 
                        <p:commandButton id="btnCancelEdit" value="Cancelar" 
                                         actionListener="#{cotizacionMB.cerrarEditar}" 
                                         update="formEditCot"/>
                    </p:panelGrid>
                </h:form>

            </p:dialog>
        <!--  FIN DIALOG DE COTIZACIONES-->


        <!-- DIALOG DE MOVIMIENTOS-->

        <!-- FIN DIALOG DE MOVIMIENTOS-->


        <!-- DIALOG DE COMPRAS-->
        <p:dialog header="Agregar Compras" widgetVar="addComprasModal" modal="true" height="300" width="500">
            <h:form id="formAddCompra">
                <h:panelGrid columns="2">
                    <p:outputLabel value="Empresa: "></p:outputLabel>
                        <p:selectOneMenu id="empresasPedido" styleClass="browser-default" value="#{compraMB.idempresaNuevo}" >
                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                            <f:selectItems   value="#{compraMB.sessionBeanCompra.listaEmpresaAdd}"  var="emp" 
                                             itemValue="#{emp.idempresa}" itemLabel="#{emp.nombre}"/>    
                        </p:selectOneMenu>
                        <p:outputLabel value="Almacen: "></p:outputLabel>
                        <p:selectOneMenu id="almacenesCompra" styleClass="browser-default" value="#{compraMB.idalmacenNuevo}" >
                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                            <f:selectItems value="#{compraMB.sessionBeanCompra.listaAlmacenesAdd}" var="alm" 
                                           itemValue="#{alm.idalmacen}" itemLabel="#{alm.nombre}"/>
                        </p:selectOneMenu>

                    <p:outputLabel value="NÂ° de Serie "></p:outputLabel>
                    <p:inputText   value="#{compraMB.serieNuevo}"/>

                    <p:outputLabel value="Correlativo: "></p:outputLabel>
                    <p:inputText   value="#{compraMB.correlativoNuevo}"/>


                </h:panelGrid>
                    <p:commandButton value="Agregar Pedidos" actionListener="#{compraMB.OpenAddPedido}"/>
                    <br/><br/><br/>
                    <p:commandButton id="agrNuevoCompra" value="Agregar" actionListener="#{compraMB.addNuevoCompra}" />
                </h:form>
            </p:dialog> 
            <p:dialog header="Agregar Pedidos" widgetVar="addPedidosItemsModal" modal="true" height="500" width="700"> 
                <h:form id="formAddPedidoss">
                    <p:outputLabel value="Pedidos Disponibles "></p:outputLabel>
                    <p:dataTable tableStyleClass="table table-hover" var="tPealtipoitem" value="#{compraMB.listPealItem}" >
                        <p:column headerText="Nombre" style="text-align: center">
                            <p:outputLabel value="#{tPealtipoitem.nombreItems}"/>
                        </p:column>
                        <p:column headerText="Cantidad" style="text-align: center">
                            <p:outputLabel value="#{tPealtipoitem.cantidad}"/>
                        </p:column>
                        <p:column headerText="Costo Unitario" style="text-align: center">
                            <p:outputLabel value="#{tPealtipoitem.costoUni}"/>
                        </p:column>
                    </p:dataTable>
                    <br/>

                <p:commandButton value="Agregar Pedidos"  />
                <br/><br/><br/><br/>
                <p:outputLabel value="Pedidos Seleccionados "></p:outputLabel>
                <p:dataTable tableStyleClass="table table-hover"   >
                    <p:column headerText="Nombre" style="text-align: center">

                    </p:column>
                    <p:column headerText="Cantidad" style="text-align: center">

                    </p:column>
                    <p:column headerText="Costo Unitario" style="text-align: center">

                    </p:column>
                </p:dataTable>
                <br/>
                <p:commandButton value="Quitar Pedido" />
                <br/><br/><br/>
                <p:commandButton value="Aceptar" onclick="PF('addPedidosItemsModal').hide();"/>
            </h:form>
        </p:dialog>
            <!-- FIN DIALOG DE COMPRAS-->


        <!-- DIALOG DE PEDIDOS-->
            <p:dialog header="Agregar Pedidos" widgetVar="addPedidosModal" modal="true" resizable="true">
                <h:form id="formAddPedido">
                    <h:panelGrid columns="2">
                        <p:outputLabel value="Empresa: "></p:outputLabel>
                        <p:selectOneMenu id="empresasPedido" styleClass="browser-default" value="#{pedidoMB.empresaAdd}">
                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                            <f:selectItems value="#{pedidoMB.listaEmpresaAdd}" var="emp" 
                                           itemValue="#{emp.idempresa}" itemLabel="#{emp.nombre}"/>
                        </p:selectOneMenu>
                        <p:outputLabel value="NÂ° de Serie "></p:outputLabel>
                        <p:inputText   value="#{pedidoMB.serieAdd}"/>
                        <p:outputLabel value="Correlativo: "></p:outputLabel>
                        <p:inputText   value="#{pedidoMB.correlativoAdd}"/>
                        <p:outputLabel value="Almacen: "></p:outputLabel>
                        <p:selectOneMenu id="almacenesPedido" styleClass="browser-default" value="#{pedidoMB.almacenAdd}">
                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                            <f:selectItems value="#{pedidoMB.listaAlmacenesAdd}" var="alm" 
                                           itemValue="#{alm.idalmacen}" itemLabel="#{alm.nombre}"/>
                        </p:selectOneMenu>
                    </h:panelGrid>
                    <p:commandButton value="Agregar Items" onclick="PF('addItemsPedidosModal').show();"/>
                    <br/><br/><br/>
                        <p:commandButton value="Agregar" actionListener="#{pedidoMB.addNuevoPedido}"/>
                </h:form>
            </p:dialog> 

            <p:dialog header="Agregar Items" widgetVar="addItemsPedidosModal" modal="true" resizable="false"> 
                <p:outputLabel value="Items Disponibles "></p:outputLabel>
                <h:form id="formAddItems">
                    <p:dataTable tableStyleClass="table table-hover"  id="tabItemsAdd" value="#{pedidoMB.listaItemsDisponibles}" var="tItemsDisp" 
                                 selectionMode="single" selection="#{pedidoMB.objTipoItem}" rowKey="#{tItemsDisp.nombre}">
                        <p:ajax event="rowSelect" listener="#{pedidoMB.selectTipoItemAdd}" /> 
                        <p:column headerText="Nombre" style="text-align: center">
                            <p:outputLabel value="#{tItemsDisp.nombre}"/>
                        </p:column>
                        <p:column headerText="Tipo" style="text-align: center">
                            <p:outputLabel value="#{tItemsDisp.tipo}"/>
                        </p:column>
                        <p:column headerText="Precio Lista" style="text-align: center">
                            <p:outputLabel value="#{tItemsDisp.precioLista}"/>
                        </p:column>
                    </p:dataTable>
                    <p:commandButton value="Agregar Item" actionListener="#{pedidoMB.agregarTipoItem}"/>
                </h:form>
                <p:outputLabel value="Items Seleccionados "></p:outputLabel>
                <h:form id="formTbSelec">
                    <p:dataTable tableStyleClass="table table-hover"  id="tabItemsSelected" value="#{pedidoMB.listaItemsSeleccionado}" var="tItemsSelec" 
                                 selectionMode="single" selection="#{pedidoMB.objTipoItemQuitar}" rowKey="#{tItemsSelec.nombre}">
                        <p:ajax event="rowSelect" listener="#{pedidoMB.selectTipoItemQuitar}"/> 
                        <p:column headerText="Nombre" style="text-align: center">
                            <p:outputLabel value="#{tItemsSelec.nombre}"/>
                        </p:column>
                        <p:column headerText="Tipo" style="text-align: center">
                            <p:outputLabel value="#{tItemsSelec.tipo}"/>
                        </p:column>
                        <p:column headerText="Precio Lista" style="text-align: center">
                            <p:outputLabel value="#{tItemsSelec.precioLista}"/>
                        </p:column>
                        <p:column headerText="Precio Lista" style="text-align: center">
                            <p:outputLabel value="#{tItemsSelec.cantidad}"/>
                        </p:column>
                    </p:dataTable>
                    <p:commandButton value="Quitar Item" actionListener="#{pedidoMB.quitarTipoItem}"/>
                </h:form>
                <br/><br/><br/>
            <p:commandButton value="Aceptar" onclick="PF('addItemsPedidosModal').hide();"/>

        </p:dialog>

            <p:dialog header="Agregar Cantidad" widgetVar="addCantidad" modal="true" resizable="false">
                <h:form id="formCantidadItem">
                    <h:panelGrid columns="2">
                        <p:outputLabel value="Cantidad"></p:outputLabel>
                        <p:inputText value="#{pedidoMB.cantidadAdd}"/>
                    </h:panelGrid>
                    <p:commandButton value="Aceptar" actionListener="#{pedidoMB.agregarCantidad}"/>
                </h:form>
            </p:dialog>
            
            <p:dialog header="Agregar Cantidad" widgetVar="editPedidoModal" modal="true" resizable="false">
                <h:form id="formEditPedido">
                    <h:panelGrid columns="2">
                        <p:outputLabel value="Empresa: "></p:outputLabel>
                        <p:selectOneMenu id="empresasPedido" styleClass="browser-default" value="#{pedidoMB.empresasEdit}" disabled="false" >
                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                            <f:selectItems value="#{pedidoMB.listaEmpresaEdit}" var="emp" 
                                           itemValue="#{emp.idempresa}" itemLabel="#{emp.nombre}"/>
                        </p:selectOneMenu>
                        <p:outputLabel value="NÂ° de Serie "></p:outputLabel>
                        <p:inputText   value="#{pedidoMB.serieEdit}"/>
                        <p:outputLabel value="Correlativo: "></p:outputLabel>
                        <p:inputText   value="#{pedidoMB.correlativEdit}"/>
                        <p:outputLabel value="Almacen: "></p:outputLabel>
                        <p:selectOneMenu id="almacenesPedido" styleClass="browser-default" value="#{pedidoMB.almacenEdit}" >
                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                            <f:selectItems value="#{pedidoMB.listaAlmacenesEdit}" var="alm" 
                                           itemValue="#{alm.idalmacen}" itemLabel="#{alm.nombre}"/>
                        </p:selectOneMenu>
                        <p:commandButton value="Agregar Items" actionListener="#{pedidoMB.agregarCantidad}"/>
                    </h:panelGrid>
                    <p:commandButton value="Aceptar" actionListener="#{pedidoMB.agregarCantidad}"/>
                </h:form>
            </p:dialog>
            <!-- FIN DIALOG DE PEDIDOS-->


        <!-- DIALOG DE TIPOITEM-->
        <p:dialog header="Registrar Item" widgetVar="registrarItem" minHeight="40" height="500" width="1350">

            <h:form id="formRegistrar">

                <h:panelGrid columns="4"  id="panelRegistrarItem">

                    <p:outputLabel value="Cod. Item:" for="codigoItem"/>                            
                    <p:inputText id="codigoItem" value="#{tipoitemMB.codigoItem}"/>

                    <p:outputLabel value="Nombre Item:" for="nombreItem"/>                            
                    <p:inputText id="nombreItem" value="#{tipoitemMB.nombre}"/>

                    <p:outputLabel value="Num. Parte:" for="numParteItem"/>                            
                    <p:inputText id="numParteItem" value="#{tipoitemMB.numParte}"/>

                    <p:outputLabel value="Descripcion:" for="descripcionItem"/>                            
                    <p:inputText id="descripcionItem" value="#{tipoitemMB.descripcion}"/>

                    <p:outputLabel value="Tipo" for="tipoItem"/>                            
                    <p:inputText id="tipoItem" value="#{tipoitemMB.tipo}"/>

                    <p:outputLabel value="Precio:" for="precioItem"/>                            
                    <p:inputText id="precioItem" value="#{tipoitemMB.precio}"/>

                    <p:outputLabel value="Dsco. Cliente:" for="dsctClienteItem"/>                            
                    <p:inputText id="dsctClienteItem" value="#{tipoitemMB.dsctoCliente}"/>                      

                    <p:outputLabel value="Dsco. Distribuidor:" for="dsctDistribuidorItem"/>                            
                    <p:inputText id="dsctDistribuidorItem" value="#{tipoitemMB.dsctoDistribuidor}"/>



                    <p:outputLabel value="Familia:" for="familiaItem"/>                            
                    <p:selectOneMenu id="familiaItem" styleClass="browser-default" value="#{tipoitemMB.familiaSelect}"  >
                        <f:selectItem itemLabel="Seleccione familia..." itemValue="0" />
                        <f:selectItems value="#{tipoitemMB.listaFamilia}" var="nomFamilia" 
                                       itemValue="#{nomFamilia.idfamilia}" itemLabel="#{nomFamilia.nombre}"/>
                    </p:selectOneMenu>                        

                    <p:outputLabel value="Marca:" for="marcaItem"/>                            
                    <p:selectOneMenu id="marcaItem" styleClass="browser-default" value="#{tipoitemMB.marcaSelect}" >
                        <f:selectItem itemLabel="Seleccione marca..." itemValue="0" />
                        <f:selectItems value="#{tipoitemMB.listaMarca}" var="nomMarca" 
                                       itemValue="#{nomMarca.idmarca}" itemLabel="#{nomMarca.nombre}"/>
                    </p:selectOneMenu>
                    <p:outputLabel value="Color:" for="colorItem"/>                            
                    <p:selectOneMenu id="colorItem" styleClass="browser-default" value="#{tipoitemMB.colorSelect}" >
                        <f:selectItem itemLabel="Seleccione color..." itemValue="0" />
                        <f:selectItems value="#{tipoitemMB.listaColor}" var="nomColor" 
                                       itemValue="#{nomColor.idcolor}" itemLabel="#{nomColor.nombre}"/>
                    </p:selectOneMenu>

                    <p:outputLabel value="CaracterÃ­sticas:" for="caracteristicasItem"/>                            
                    <p:selectOneMenu id="caracteristicasItem" styleClass="browser-default" value="#{tipoitemMB.caracteristicaSelect}" >
                        <f:selectItem itemLabel="Seleccione caracterÃ­stica..." itemValue="0" />
                        <f:selectItems value="#{tipoitemMB.listaCaracteristicas}" var="nomCaracteristica" 
                                       itemValue="#{nomCaracteristica.idcaracteristica}" itemLabel="#{nomCaracteristica.nombre}"/>
                    </p:selectOneMenu>
                </h:panelGrid>
                <p:commandButton value="Agregar" actionListener="#{tipoitemMB.listarTablaCaracteristicas}" update="formRegistrar:panelRegistrarItem,tabla2"/> 
                <p:commandButton value="Quitar" id="btnQuitarCaracteristica" actionListener="#{tipoitemMB.quitarElementosTablaCaracteristicas}" update="formRegistrar:panelRegistrarItem,tabla2"/>       
                <p:dataTable id="tabla2" value="#{tipoitemMB.lista2}" var="tite" selectionMode="single" 
                             rowKey="#{tite.idcaracteristica}" 
                             scrollable="true" rows="5" selection="#{tipoitemMB.caracteristicasTablaSelect}"> 
                    <p:ajax event="rowSelect"  />
                    <p:column headerText="CaracterÃ­sticas">
                        <h:outputText value="#{tite.nombre}" />
                    </p:column>                            
                </p:dataTable>
                <p:commandButton value="Crear una nueva caracterÃ­stica"  actionListener="#{tipoitemMB.registrarCaracteristica}"/>
                <p:commandButton value="Crear una nueva marca"  actionListener="#{tipoitemMB.registrarMarca}" />

                <p:commandButton  value="Registrar nuevo Item" actionListener="#{tipoitemMB.registrarNuevoTipoItem}"/>


            </h:form>

                <!-- CREAR NUEVA CARACTERISTICA -->
        </p:dialog>

        <p:dialog header="Crear CaracterÃ­stica" widgetVar="crearCaraItem" minHeight="40" height="150" width="700">
            <h:form>
                <h:panelGrid columns="2" id="ee">

                    <p:outputLabel value="Nombre:" for="nombreCaracteristica"/>                            
                    <p:inputText id="nombreCaracteristica" value="#{tipoitemMB.nombreCaracteristica}"/>  
                    <p:outputLabel value="Descripcion:" for="descripCaracteristica"/>                            
                    <p:inputText id="descripCaracteristica" value="#{tipoitemMB.descripcionCaracteristica}"/>  

                    <p:commandButton  value="Crear nueva caracteristica" 
                                      actionListener="#{tipoitemMB.registrarNuevaCaracteristica}"  
                                      update="formRegistrar:panelRegistrarItem" onclick="PF('crearCaraItem').hide();"/>
                </h:panelGrid>        
            </h:form>

        </p:dialog>

            <!-- CREAR NUEVA MARCA -->
        <p:dialog header="Crear Marca" widgetVar="crearMarcaItem" minHeight="40" height="300" width="420">
            <h:form>
                <h:panelGrid columns="2">


                    <p:outputLabel value="Nombre:" for="nomCrearMarcaItem"/>                            
                    <p:inputText id="nomCrearMarcaItem" value="#{tipoitemMB.nombreMarca}" style="width: 70%"/>                

                    <p:outputLabel value="Imagen:" for="imgCrearMarcaItem"/>                            
                    <p:inputText id="imgCrearMarcaItem" value="#{tipoitemMB.imagenMarca}" style="width: 70%"/>                             
                    <p:outputLabel value="Formato:" for="formatoCrearMarcaItem"/>                            
                    <p:inputText id="formatoCrearMarcaItem" value="#{tipoitemMB.formatoMarca}" style="width: 70%"/> 



                    <p:commandButton  value="Crear Marca" actionListener="#{tipoitemMB.registrarNuevaMarca}"/>
                </h:panelGrid> 
            </h:form>
        </p:dialog>

            <!-- MODIFICAR TIPOITEM -->

        <p:dialog header="Modificar Item" widgetVar="modificarItem" minHeight="40" height="500" width="1200">

            <h:form id="formModificarTipoItem">
                <h:panelGrid columns="2" id="panelModTipoItem">

                    <p:outputLabel value="Cod. Item:" for="codigoItem"/>                            
                    <p:inputText id="codigoItem" value="#{tipoitemMB.tipoItemSelect.idtipoItem}"/>

                    <p:outputLabel value="Nombre Item:" for="nombreItem"/>                            
                    <p:inputText id="nombreItem" value="#{tipoitemMB.tipoItemSelect.nombre}"/>

                    <p:outputLabel value="Num. Parte:" for="numParteItem"/>                            
                    <p:inputText id="numParteItem" value="#{tipoitemMB.tipoItemSelect.numParte}"/>

                    <p:outputLabel value="Descripcion:" for="descripcionItem"/>                            
                    <p:inputText id="descripcionItem" value="#{tipoitemMB.tipoItemSelect.descipcion}"/>

                    <p:outputLabel value="Tipo" for="tipoItem"/>                            
                    <p:inputText id="tipoItem" value="#{tipoitemMB.tipoItemSelect.tipo}"/>

                    <p:outputLabel value="Precio:" for="precioItem"/>                            
                        <p:inputText id="precioItem" value="#{tipoitemMB.tipoItemSelect.precioLista}"/>

                    <p:outputLabel value="Dsco. Cliente:" for="dsctClienteItem"/>                            
                        <p:inputText id="dsctClienteItem" value="#{tipoitemMB.tipoItemSelect.desCliente}"/>                      

                    <p:outputLabel value="Dsco. Distribuidor:" for="dsctDistribuidorItem"/>                            
                        <p:inputText id="dsctDistribuidorItem" value="#{tipoitemMB.tipoItemSelect.desDistribuidor}"/>



                    <p:outputLabel value="Familia:" for="familiaItem"/>                            
                    <p:selectOneMenu id="familiaItem" styleClass="browser-default" value="#{tipoitemMB.familiaSelect}"  >
                        <f:selectItem itemLabel="Seleccione familia..." itemValue="0" />
                        <f:selectItems value="#{tipoitemMB.listaFamilia}" var="nomFamilia" 
                                       itemValue="#{nomFamilia.idfamilia}" itemLabel="#{nomFamilia.nombre}"/>
                    </p:selectOneMenu>

                    <p:outputLabel value="CategorÃ­a:" for="categoriaItem"/>                           

                    <p:selectOneMenu id="categoriaItem" styleClass="browser-default" value="#{tipoitemMB.categoriaSelect}">
                        <f:selectItem itemLabel="Seleccione categorÃ­a..." itemValue="0" />
                        <f:selectItems value="#{tipoitemMB.listaCategoria}" var="nomCategoria" 
                                       itemValue="#{nomCategoria.idcategoria}" itemLabel="#{nomCategoria.nombre}"/>
                    </p:selectOneMenu>

                    <p:outputLabel value="Marca:" for="marcaItem"/>                            
                    <p:selectOneMenu id="marcaItem" styleClass="browser-default" value="#{tipoitemMB.marcaSelect}" >
                        <f:selectItem itemLabel="Seleccione marca..." itemValue="0" />
                        <f:selectItems value="#{tipoitemMB.listaMarca}" var="nomMarca" 
                                       itemValue="#{nomMarca.idmarca}" itemLabel="#{nomMarca.nombre}"/>
                    </p:selectOneMenu>
                    <p:outputLabel value="Color:" for="colorItem"/>                            
                    <p:selectOneMenu id="colorItem" styleClass="browser-default" value="#{tipoitemMB.colorSelect}" >
                        <f:selectItem itemLabel="Seleccione color..." itemValue="0" />
                        <f:selectItems value="#{tipoitemMB.listaColor}" var="nomColor" 
                                       itemValue="#{nomColor.idcolor}" itemLabel="#{nomColor.nombre}"/>
                    </p:selectOneMenu>

                    <p:outputLabel value="CaracterÃ­sticas:" for="caracteristicasItem"/>                            
                    <p:selectOneMenu id="caracteristicasItem" styleClass="browser-default" value="#{tipoitemMB.caracteristicaSelect}" >
                        <f:selectItem itemLabel="Seleccione caracterÃ­stica..." itemValue="0" />
                        <f:selectItems value="#{tipoitemMB.listaCaracteristicas}" var="nomCaracteristica" 
                                       itemValue="#{nomCaracteristica.idcaracteristica}" itemLabel="#{nomCaracteristica.nombre}"/>
                    </p:selectOneMenu>

                    <p:commandButton value="Agregar" actionListener="#{tipoitemMB.listarTablaCaracteristicas}" update="tabla2"/> 

                    <p:dataTable id="tabla2" value="#{tipoitemMB.lista2}" var="tite"> 
                        <p:column headerText="CaracterÃ­sticas">
                            <h:outputText value="#{tite.nombre}" />
                        </p:column>                            
                    </p:dataTable>

                    <p:commandButton value="Quitar" update="tabla2"/>

                    <p:commandButton value="Crear una nueva caracterÃ­stica" type="button" onclick="PF('crearCaraItem').show();"/>
                    <p:commandButton value="Crear una nueva marca" type="button" onclick="PF('crearMarcaItem').show();" />

                    <p:commandButton  value="Modificar Item" actionListener="#{tipoitemMB.modificarTipoItem}"/>
                </h:panelGrid>
            </h:form>

        </p:dialog>

            <!-- FIN DIALOG DE TIPOITEM-->

    </h:body>

</f:view>
</html>

